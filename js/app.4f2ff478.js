(function(){"use strict";var e={1870:function(e,t,o){var n=o(5130),r=o(6768);const s={id:"app"};function a(e,t,o,n,a,i){const l=(0,r.g2)("MainMenu"),c=(0,r.g2)("HostGame"),u=(0,r.g2)("JoinGame"),d=(0,r.g2)("BlockGame"),m=(0,r.g2)("GameLobby");return(0,r.uX)(),(0,r.CE)("div",s,["main-menu"===a.currentView?((0,r.uX)(),(0,r.Wv)(l,{key:0,socket:a.socket,onHost:i.showHostMenu,onJoin:i.showJoinMenu},null,8,["socket","onHost","onJoin"])):"host-game"===a.currentView?((0,r.uX)(),(0,r.Wv)(c,{key:1,socket:a.socket,onJoinedLobby:i.enterLobby,onBack:i.returnToMenu},null,8,["socket","onJoinedLobby","onBack"])):"join-game"===a.currentView?((0,r.uX)(),(0,r.Wv)(u,{key:2,socket:a.socket,onJoinedLobby:i.enterLobby,onBack:i.returnToMenu},null,8,["socket","onJoinedLobby","onBack"])):"in-game"===a.currentView?((0,r.uX)(),(0,r.Wv)(d,{key:3,socket:a.socket,settings:a.lobbyInfo,store:a.store,onBack:i.returnToMenu},null,8,["socket","settings","store","onBack"])):"game-lobby"===a.currentView?((0,r.uX)(),(0,r.Wv)(m,{key:4,store:a.store,socket:a.socket,settings:a.lobbyInfo,onStart:i.startGame,onBack:i.returnToMenu},null,8,["store","socket","settings","onStart","onBack"])):(0,r.Q3)("",!0)])}const i={class:"menu-container"},l={class:"button-group"};function c(e,t,o,n,s,a){return(0,r.uX)(),(0,r.CE)("div",i,[t[2]||(t[2]=(0,r.Lk)("h1",null,"Multiplayer Worms",-1)),(0,r.Lk)("div",l,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$emit("host"))},"Host Game"),(0,r.Lk)("button",{onClick:t[1]||(t[1]=t=>e.$emit("join"))},"Join Game")])])}var u={name:"MainMenu",emits:["host","join"],props:{socket:{type:Object,required:!0}}},d=o(1241);const m=(0,d.A)(u,[["render",c],["__scopeId","data-v-4554f5e4"]]);var h=m,p=o(4232);const k={class:"menu-container"};function y(e,t,o,s,a,i){return(0,r.uX)(),(0,r.CE)("div",k,[t[6]||(t[6]=(0,r.Lk)("h2",null,"Host a Game",-1)),(0,r.Lk)("form",{onSubmit:t[4]||(t[4]=(0,n.D$)((...e)=>i.handleHostGame&&i.handleHostGame(...e),["prevent"])),class:"form-group"},[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.playerName=e),type:"text",placeholder:"Player Name"},null,512),[[n.Jo,a.playerName]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.roomName=e),type:"text",placeholder:"Room Name",required:""},null,512),[[n.Jo,a.roomName]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.password=e),type:"password",placeholder:"Password (optional)"},null,512),[[n.Jo,a.password]]),t[5]||(t[5]=(0,r.Lk)("button",{type:"submit",class:"create-button"},"Create Game",-1)),(0,r.Lk)("button",{type:"button",class:"back-button",onClick:t[3]||(t[3]=t=>e.$emit("back"))},"Back"),(0,r.Lk)("p",null,(0,p.v_)(a.msg),1)],32)])}var b={name:"HostGame",emits:["joinedLobby","back"],data(){return{roomName:"",password:"",playerName:"",msg:""}},props:{socket:{type:Object,required:!0}},mounted(){this.socket.on("joinSuccess",e=>{this.$emit("joinedLobby",e)}),this.socket.on("error",e=>{this.msg=e})},beforeUnmount(){this.socket.off("joinSuccess")},methods:{handleHostGame(){this.socket.emit("createRoom",{roomName:this.roomName,password:this.password,playerName:this.playerName})}}};const f=(0,d.A)(b,[["render",y],["__scopeId","data-v-4c834b07"]]);var v=f;const g={class:"menu-container"};function w(e,t,o,s,a,i){return(0,r.uX)(),(0,r.CE)("div",g,[t[6]||(t[6]=(0,r.Lk)("h2",null,"Join a Game",-1)),(0,r.Lk)("form",{onSubmit:t[4]||(t[4]=(0,n.D$)((...e)=>i.handleJoinGame&&i.handleJoinGame(...e),["prevent"])),class:"form-group"},[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.playerName=e),type:"text",placeholder:"Player Name"},null,512),[[n.Jo,a.playerName]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.roomName=e),type:"text",placeholder:"Room Name",required:""},null,512),[[n.Jo,a.roomName]]),(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.password=e),type:"password",placeholder:"Password"},null,512),[[n.Jo,a.password]]),t[5]||(t[5]=(0,r.Lk)("button",{type:"submit",class:"join-button"},"Join Game",-1)),(0,r.Lk)("button",{type:"button",class:"back-button",onClick:t[3]||(t[3]=t=>e.$emit("back"))},"Back"),(0,r.Lk)("p",null,(0,p.v_)(a.msg),1)],32)])}var L={name:"JoinGame",emits:["joinedLobby","back"],data(){return{roomName:"",password:"",playerName:"",msg:"",Gamefound:!0}},props:{socket:{type:Object,required:!0}},mounted(){this.socket.on("lobbyUpdate",e=>{this.$emit("joinedLobby",e)}),this.socket.on("error",e=>{this.msg=e})},methods:{handleJoinGame(){this.socket.emit("joinRoom",{roomName:this.roomName,password:this.password,playerName:this.playerName})}}};const C=(0,d.A)(L,[["render",w],["__scopeId","data-v-5b6ac5a4"]]);var I=C;const x={class:"game-container"},N={key:0,class:"overlay"},G={id:"loser-overlay-content"},S={class:"leaderboard-wrapper"},j={key:0,id:"winner"},A=["width","height"],D={key:1,class:"instructions"};function _(e,t,o,n,s,a){const i=(0,r.g2)("GameLeaderboard");return(0,r.uX)(),(0,r.CE)("div",x,[s.playerDead?((0,r.uX)(),(0,r.CE)("div",N,[(0,r.Lk)("div",G,[t[2]||(t[2]=(0,r.Lk)("h2",null,"Game Over",-1)),(0,r.Lk)("div",S,[(0,r.bF)(i,{scores:a.leaderboard,everyoneDead:a.everyoneDead},null,8,["scores","everyoneDead"]),a.everyoneDead?((0,r.uX)(),(0,r.CE)("span",j,(0,p.v_)(a.leaderboard[0].playerName)+" wins! ",1)):(0,r.Q3)("",!0)]),(0,r.Lk)("button",{class:"play-again-button",onClick:t[0]||(t[0]=(...e)=>a.handleBack&&a.handleBack(...e))},"Main menu"),a.everyoneDead&&s.hostId===o.store.playerToken?((0,r.uX)(),(0,r.CE)("button",{key:0,class:"play-again-button",onClick:t[1]||(t[1]=(...e)=>a.handlePlayAgain&&a.handlePlayAgain(...e))},"Play again ")):(0,r.Q3)("",!0)])])):(0,r.Q3)("",!0),(0,r.bF)(i,{scores:a.leaderboard,everyoneDead:a.everyoneDead},null,8,["scores","everyoneDead"]),(0,r.Lk)("canvas",{ref:"game",width:s.CANVAS_WIDTH,height:s.CANVAS_HEIGHT},null,8,A),s.playerDead?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("p",D," Use Arrow Keys or WASD to move. "))])}o(8111),o(1148),o(116),o(1701);const T={class:"leaderboard-containter"},O={class:"leaderboard-list"},E={class:"rank"},H={class:"name"},J={class:"name"};function V(e,t,o,n,s,a){return(0,r.uX)(),(0,r.CE)("div",T,[t[0]||(t[0]=(0,r.Lk)("h2",null,"Leaderboard",-1)),(0,r.Lk)("ol",O,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.scores,(e,t)=>((0,r.uX)(),(0,r.CE)("li",{key:e.id,class:(0,p.C4)({"top-player":0===t&&o.everyoneDead})},[(0,r.Lk)("span",E,(0,p.v_)(t+1),1),(0,r.Lk)("span",H,[(0,r.Lk)("span",{class:"color-swatch",style:(0,p.Tr)({backgroundColor:e.color})},null,4),(0,r.eW)(" "+(0,p.v_)(e.playerName),1)]),(0,r.Lk)("span",J,(0,p.v_)(e.score-1),1)],2))),128))])])}var X={name:"GameLeaderboard",props:{scores:{type:Array,required:!0},everyoneDead:{type:Boolean,required:!0}}};const B=(0,d.A)(X,[["render",V],["__scopeId","data-v-74c5a4e6"]]);var M=B,R={name:"BlockGame",emits:["back"],components:{GameLeaderboard:M},props:{socket:{type:Object,required:!0},settings:{type:Object,required:!0},store:{type:Object,required:!0}},data(){return{context:{},players:{},food:null,hostId:null,playerDead:!1,kickTimer:null,currentDirection:"none",CANVAS_WIDTH:640,CANVAS_HEIGHT:480}},computed:{leaderboard(){return Object.values(this.players).map(e=>({id:e.socketId,playerName:e.playerName,color:e.color,score:e.segments.length})).sort((e,t)=>t.score-e.score)},everyoneDead(){const e=Object.values(this.players);return 0!==e.length&&e.every(e=>!e.alive)}},mounted(){window.addEventListener("keydown",this.handleKeydown),this.context=this.$refs.game.getContext("2d"),this.socket.on("kickPlayer",()=>{this.$emit("back")}),console.log(this.hostId,this.store.playerToken),this.socket.on("updateState",e=>{this.players=e.players,this.food=e.food,this.hostId=e.hostId,this.context.clearRect(0,0,this.$refs.game.width,this.$refs.game.height);for(let o=0;o<this.CANVAS_WIDTH/20;o++)for(let e=0;e<this.CANVAS_HEIGHT/20;e++)this.context.strokeStyle="#c2c2c2",this.context.strokeRect(20*o,20*e,20,20);this.food&&(this.context.fillStyle="green",this.context.fillRect(this.food.x,this.food.y,20,20),this.context.strokeRect(this.food.x,this.food.y,20,20));for(const o in this.players){const e=this.players[o];for(const t of e.segments)this.context.fillStyle=e.color,this.context.strokeStyle="black",this.context.fillRect(t.x,t.y,20,20),this.context.strokeRect(t.x,t.y,20,20),t===e.segments[0]&&e.alive?(this.context.fillStyle="black",this.context.fillRect(t.x,t.y+8,4,4),this.context.fillRect(t.x+15,t.y+8,4,4)):t!==e.segments[0]||e.alive||(this.context.fillStyle="black",this.context.fillRect(t.x,t.y+8,4,2),this.context.fillRect(t.x+15,t.y+8,4,2))}const t=Object.values(this.players).find(e=>e.socketId==this.socket.id);t&&!1===t.alive?this.playerDead=!0:this.playerDead=!1})},beforeUnmount(){window.removeEventListener("keydown",this.handleKeydown),this.socket.off("updateState"),this.socket.off("kickPlayer"),this.socket.off("playAgain")},methods:{handleKeydown(e){let t=this.currentDirection;switch(e.key){case"ArrowUp":case"w":"down"!==this.currentDirection&&(t="up");break;case"ArrowDown":case"s":"up"!==this.currentDirection&&(t="down");break;case"ArrowLeft":case"a":"right"!==this.currentDirection&&(t="left");break;case"ArrowRight":case"d":"left"!==this.currentDirection&&(t="right");break}t!==this.currentDirection&&(this.currentDirection=t,this.socket.emit("changeDirection",t,this.settings))},handleBack(){this.$emit("back"),this.socket.emit("leaveRoom",{id:this.settings.id})},handlePlayAgain(){this.socket.emit("playAgain",this.settings)}}};const $=(0,d.A)(R,[["render",_],["__scopeId","data-v-598092da"]]);var P=$;const U={class:"menu-container"},q={class:"player-list"},W={key:0,class:"host-tag"},K={class:"button-group"};function Q(e,t,o,n,s,a){return(0,r.uX)(),(0,r.CE)("div",U,[(0,r.Lk)("h1",null,"Lobby: "+(0,p.v_)(o.settings.roomName),1),(0,r.Lk)("ol",q,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.players,e=>((0,r.uX)(),(0,r.CE)("li",{key:e.playerId},[(0,r.eW)((0,p.v_)(e.playerName)+" ",1),e.playerId===s.roomInfo.hostId?((0,r.uX)(),(0,r.CE)("span",W,"(Host)")):(0,r.Q3)("",!0)]))),128))]),(0,r.Lk)("div",K,[(0,r.Lk)("button",{type:"button",onClick:t[0]||(t[0]=(...e)=>a.handleBack&&a.handleBack(...e))},"Back"),a.isHost?((0,r.uX)(),(0,r.CE)("button",{key:0,type:"button",onClick:t[1]||(t[1]=(...e)=>a.handleStart&&a.handleStart(...e))}," Start Game ")):(0,r.Q3)("",!0)])])}var F={name:"GameLobby",emits:["start","back"],props:{socket:{type:Object,required:!0},settings:{type:Object,required:!0},store:{type:Object,required:!0}},data(){return{players:[],roomInfo:{},color:""}},computed:{isHost(){return this.store.playerToken===this.roomInfo.hostId}},mounted(){this.socket.on("lobbyUpdate",e=>{this.players=e.players,this.roomInfo=e}),this.socket.on("start",()=>{this.$emit("start",this.roomInfo)}),this.roomInfo=this.settings,this.players=this.settings.players},beforeUnmount(){this.socket.off("lobbyUpdate")},methods:{handleBack(){this.socket.emit("leaveRoom",{id:this.roomInfo.id}),this.$emit("back")},handleStart(){this.socket.emit("startGame",this.roomInfo)},handleColorChange(e){console.log("Color picker event fired! New color object:",e),this.socket.emit("playerChangeColor",e.hex)}}};const z=(0,d.A)(F,[["render",Q],["__scopeId","data-v-e5a6ee2e"]]);var Y=z,Z=o(1714),ee=o(144);const te=(0,ee.Kh)({playerToken:localStorage.getItem("playerToken")||null});var oe={name:"App",components:{MainMenu:h,HostGame:v,JoinGame:I,BlockGame:P,GameLobby:Y},data(){return{socket:null,currentView:"main-menu",lobbyInfo:{},store:te}},created(){this.socket=(0,Z.Ay)("https://multiplayer-worms.onrender.com"),this.socket.on("setToken",e=>{te.playerToken=e,localStorage.setItem("playerToken",e)}),this.socket.on("invalidToken",()=>{console.error("Server rejected our token. It was invalid or expired."),localStorage.removeItem("playerToken"),te.playerToken=null})},methods:{showHostMenu(){this.currentView="host-game"},showJoinMenu(){this.currentView="join-game"},startGame(e){console.log("Starting game with settings:",e),this.lobbyInfo=e,this.currentView="in-game"},returnToMenu(){this.currentView="main-menu"},enterLobby(e){this.lobbyInfo=e,this.currentView="game-lobby"}}};const ne=(0,d.A)(oe,[["render",a]]);var re=ne;(0,n.Ef)(re).mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,o),s.exports}o.m=e,function(){var e=[];o.O=function(t,n,r,s){if(!n){var a=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],s=e[u][2];for(var i=!0,l=0;l<n.length;l++)(!1&s||a>=s)&&Object.keys(o.O).every(function(e){return o.O[e](n[l])})?n.splice(l--,1):(i=!1,s<a&&(a=s));if(i){e.splice(u--,1);var c=r();void 0!==c&&(t=c)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,r,s]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,s,a=n[0],i=n[1],l=n[2],c=0;if(a.some(function(t){return 0!==e[t]})){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(l)var u=l(o)}for(t&&t(n);c<a.length;c++)s=a[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(u)},n=self["webpackChunkclient"]=self["webpackChunkclient"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],function(){return o(1870)});n=o.O(n)})();
//# sourceMappingURL=app.4f2ff478.js.map